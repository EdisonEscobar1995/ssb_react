"use strict";(self.webpackChunkssb=self.webpackChunkssb||[]).push([[687],{281:function(e,t,n){n.d(t,{i:function(){return p}});var r=n(1413),a=n(3433),s=n(4519),o=n(6162),i=n(6894),c=n(2513),l=n(5492),u=n(2704),d=n(9151),m=n(2556),p=function(e){var t=e.title,n=e.columns,p=e.dataSource,f=e.addButtons,h=e.addActions,x=e.loading,b=e.filterComponent,Z=(0,a.Z)(n);return h&&h.length>0&&Z.push({title:"Acciones",key:"",align:"right",width:50*(h&&h.length||0),render:function(e,t){return h&&h.map((function(e,n){return(0,m.jsxs)(o.Z,{title:e.text,children:[" ",e.confirm?(0,m.jsx)(i.Z,{title:e.confirm,okText:e.okText||"Ok",cancelText:e.cancelText||"Cancel",placement:"bottomRight",onConfirm:function(){return e.onClick(t)},children:(0,m.jsx)(c.Z,{type:e.type||"ghost",shape:"circle",icon:e.icon})}):(0,m.jsx)(c.Z,{type:e.type||"ghost",shape:"circle",icon:e.icon,onClick:function(){return e.onClick(t)}})]},"action-button-".concat(n,"-").concat((null===t||void 0===t?void 0:t.id)||n))}))}}),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(l.Z,{className:"row-title",children:[(0,m.jsx)(u.Z,{children:t||""}),(0,m.jsx)(u.Z,{children:f&&f.map((function(e,t){return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(c.Z,(0,r.Z)((0,r.Z)({size:"large",type:"primary"},e),{},{children:e.text}))," "]},"button-section-".concat(t))}))})]}),b&&(0,m.jsx)(m.Fragment,{children:b}),(0,m.jsx)(d.Z,{scroll:{x:!0},columns:Z,dataSource:p,className:"custom-table",loading:x})]})}},1687:function(e,t,n){n.r(t),n.d(t,{default:function(){return O}});var r=n(4165),a=n(5861),s=n(9439),o=n(4519),i=n(281),c=n(332),l=n(4367),u=n(1749),d=n(8501),m=n(2556),p=function(e){var t=e.dataSource,n=e.loading,r=e.handleDelete,a=e.handleVisibleForm,s=((0,c.s0)(),[{title:"Backend",dataIndex:"backend",key:"backend",render:function(e){return(0,m.jsx)("a",{children:e})},sorter:function(e,t){var n=e.backend.toLocaleLowerCase().localeCompare(t.backend.toLocaleLowerCase());return 0===n&&e!==t?t.backend.localeCompare(e.backend):n}},{title:"Operation",dataIndex:"operation",key:"operation",sorter:function(e,t){var n=e.operation.toLocaleLowerCase().localeCompare(t.operation.toLocaleLowerCase());return 0===n&&e!==t?t.operation.localeCompare(e.operation):n}},{title:"Number requests",dataIndex:"numberRequests",key:"numberRequests",sorter:function(e,t){return parseFloat(e.numberRequests)-parseFloat(t.numberRequests)}},{title:"Timestamp",key:"timestamp",dataIndex:"timestamp",sorter:function(e,t){var n=e.timestamp.toLocaleLowerCase().localeCompare(t.timestamp.toLocaleLowerCase());return 0===n&&e!==t?t.timestamp.localeCompare(e.timestamp):n}}]);return(0,m.jsx)(i.i,{title:"Alertas",columns:s,dataSource:t,addButtons:[{text:"Crear Alerta",icon:(0,m.jsx)(l.Z,{}),onClick:function(){return a()}}],addActions:[{text:"Editar",icon:(0,m.jsx)(u.Z,{}),type:"primary",onClick:function(e){a(e)}},{text:"Eliminar",icon:(0,m.jsx)(d.Z,{}),type:"danger",okText:"Ok",confirm:"\xbfEst\xe1 seguro que desea eliminar esta alarma?",onClick:function(e){return t=e._id,console.log("id == ",t),void r(t);var t}}],loading:n})},f=n(1413),h=n(3008),x=n(9918),b=n(8874),Z=n(5492),v=n(2704),k=n(2036),j=n(5398),g=h.Z.Option,C=function(e){var t=e.visible,n=e.readonly,r=e.title,a=e.handleCancel,i=e.handleSubmit,c=e.alertSelect,l=c.backend,u=c.numberRequests,d=c.operation,p=c.timestamp,C=x.Z.useForm(),y=(0,s.Z)(C,1)[0];(0,o.useEffect)((function(){t&&y.setFieldsValue({backend:l,numberRequests:parseFloat(u),operation:d,timestamp:p})}),[t]);var S={labelCol:{xxl:8,xl:9},wrapperCol:{xxl:16,xl:15}};return(0,m.jsx)(b.Z,{visible:t,title:r,okText:"Aceptar",cancelText:"Cancelar",onCancel:a,onOk:function(){y.validateFields().then((function(e){i({backend:e.backend,numberRequests:e.numberRequests},function(e){var t="";switch(e){case"W":t="warning";break;case"C":t="cutoff";break;default:t="recover"}return t}(e.operation))}))},afterClose:function(){y.resetFields()},closable:!1,maskClosable:!1,width:"50%",className:"custom-modal-plantsForm",forceRender:!0,centered:!0,children:(0,m.jsxs)(x.Z,{form:y,children:[(0,m.jsx)(Z.Z,{gutter:8,children:(0,m.jsx)(v.Z,{span:20,children:(0,m.jsx)(x.Z.Item,(0,f.Z)((0,f.Z)({label:"Operation",name:"operation",rules:[{required:!0,message:"Operation must be required"}]},S),{},{children:(0,m.jsx)(h.Z,{disabled:n,children:[{id:"W",name:"Warning"},{id:"C",name:"Cutoff"},{id:"R",name:"Recover"}].map((function(e){return(0,m.jsx)(g,{value:e.id,children:e.name})}))})}))})}),(0,m.jsx)(Z.Z,{gutter:8,children:(0,m.jsx)(v.Z,{span:20,children:(0,m.jsx)(x.Z.Item,(0,f.Z)((0,f.Z)({label:"Backend",name:"backend",rules:[{required:!0,message:"Backend must be required"}]},S),{},{children:(0,m.jsx)(h.Z,{disabled:n,children:[{id:"LMS",name:"LMS"},{id:"BDC",name:"BDC"},{id:"SSB",name:"SSB"},{id:"INFR",name:"INFR"},{id:"SCN",name:"SCN"},{id:"MS",name:"MS"},{id:"WCO",name:"WCO"},{id:"STL",name:"STL"}].map((function(e){return(0,m.jsx)(g,{value:e.id,children:e.name})}))})}))})}),(0,m.jsx)(Z.Z,{gutter:8,children:(0,m.jsx)(v.Z,{span:20,children:(0,m.jsx)(x.Z.Item,(0,f.Z)((0,f.Z)({label:"Number Requests",name:"numberRequests",rules:[{required:!0,message:"Number Requests must be required"}]},S),{},{children:(0,m.jsx)(k.Z,{style:{width:"100%"},disabled:n,min:0})}))})}),""!==c.backend&&(0,m.jsx)(Z.Z,{gutter:8,children:(0,m.jsx)(v.Z,{span:20,children:(0,m.jsx)(x.Z.Item,(0,f.Z)((0,f.Z)({label:"Timestamp",name:"timestamp",rules:[{required:!0,message:"Timestamp must be required"}]},S),{},{children:(0,m.jsx)(j.Z,{disabled:!0})}))})})]})})},y=n(3687),S=n(3144),q=n(5671),w=n(6787),A=n.n(w),R=function(){function e(){(0,q.Z)(this,e)}return(0,S.Z)(e,null,[{key:"mapperAlert",value:function(e){var t=null;return e&&(t={backend:e.backend||"",numberRequests:e.numberRequests||"",operation:e.operation||"",timestamp:e.timestamp||""}),t}},{key:"mapperAlerts",value:function(e){var t=this;return e.map((function(e){return t.mapperAlert(e)}))}}]),e}(),L="https://dev.santillanar4.com",F=(0,S.Z)((function e(){(0,q.Z)(this,e)}));F.getAlerts=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,s,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(L,"/v0.1/agent/alerts"),e.next=3,A().get(n,{headers:{Authorization:"Bearer ".concat(t),Accept:"application/json;odata=verbose"}});case 3:return a=e.sent,s=a.data,console.log(s),o=R.mapperAlerts(s),e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F.saveAlert=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n,a){var s,o,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="".concat(L,"/v0.1/agent/").concat(a),e.next=3,A().post(s,n,{headers:{Authorization:"Bearer ".concat(t),Accept:"application/json;odata=verbose"}});case 3:return o=e.sent,i=o.data,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();var T=n(5447),I=n(1449),B=function(e){var t=e.message,n=e.description,r=e.type,a=void 0===r?"info":r,s=e.placement,o=void 0===s?"topRight":s,i=e.duration,c=void 0===i?4.5:i;return I.Z[a]({description:"object"===typeof n?n:(0,m.jsx)("div",{dangerouslySetInnerHTML:{__html:n}}),message:"object"===typeof t?t:(0,m.jsx)("div",{dangerouslySetInnerHTML:{__html:t}}),placement:o,duration:c})},N=function(){var e=(0,o.useContext)(y.Z).setDefaultMenu,t=(0,T.aC)().authService.getAuthTokens(),n=(0,o.useState)(!1),i=(0,s.Z)(n,2),c=i[0],l=i[1],u=(0,o.useState)(!1),d=(0,s.Z)(u,2),f=d[0],h=d[1],x=(0,o.useState)([]),b=(0,s.Z)(x,2),Z=b[0],v=b[1],k=(0,o.useState)(""),j=(0,s.Z)(k,2),g=j[0],S=j[1],q={backend:"",numberRequests:"",operation:"",timestamp:""},w=(0,o.useState)(q),A=(0,s.Z)(w,2),R=A[0],L=A[1],I=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l(!0),e.next=4,F.getAlerts(null===t||void 0===t?void 0:t.access_token);case 4:n=e.sent,v(n),l(!1),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),l(!1),console.error("Error en getAlerts = ",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();(0,o.useEffect)((function(){e&&e("alerts"),l(!0),I()}),[]);var N=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n,a){var s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,F.saveAlert(null===t||void 0===t?void 0:t.access_token,n,a);case 4:s=e.sent,console.log(s),s&&"200"===s.code&&(B({type:"success",message:s.message}),h(!1),I()),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),l(!1),console.error("Error en saveAlert = ",e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}();return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(p,{dataSource:Z,loading:c,handleDelete:function(){},handleVisibleForm:function(e){S("Crear alarma"),L(q),e&&(L(e),S("Editar alarma")),h(!0)}}),(0,m.jsx)(C,{title:g,visible:f,handleCancel:function(){return h(!1)},handleSubmit:N,readonly:!1,alertSelect:R})]})},O=function(){return(0,m.jsx)(N,{})}}}]);
//# sourceMappingURL=687.c95c2bbd.chunk.js.map